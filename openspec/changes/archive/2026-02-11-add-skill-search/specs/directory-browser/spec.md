## ADDED Requirements

### Requirement: 搜索过滤

系统 SHALL 在目录浏览器的选择界面中提供搜索过滤能力，用户可通过输入关键词实时过滤当前层级的条目列表。

#### Scenario: 无输入时展示全部条目

- **WHEN** 用户未输入任何搜索关键词
- **THEN** 系统 SHALL 展示当前层级的全部条目，行为与未启用搜索时完全一致

#### Scenario: 输入关键词过滤内容条目

- **WHEN** 用户输入搜索关键词
- **THEN** 系统 SHALL 对内容类条目（📁 目录、✨ 技能、📄 资源）按名称和描述进行大小写不敏感的子串匹配，仅展示匹配的条目

#### Scenario: 操作类选项不受过滤影响

- **WHEN** 用户输入搜索关键词
- **THEN** 操作类选项（⬆️ 返回上层、🔘 全选/取消全选、✅ 确认下载、❌ 取消）SHALL 始终可见，不受搜索过滤影响

#### Scenario: 无匹配结果

- **WHEN** 用户输入的关键词未匹配到任何内容类条目
- **THEN** 系统 SHALL 仅展示操作类选项，不显示任何内容类条目

#### Scenario: 搜索状态不跨层级保持

- **WHEN** 用户在搜索过滤状态下选择导航操作（进入子目录或返回上层）
- **THEN** 搜索输入 SHALL 被清空，新目录层级展示全部条目

## MODIFIED Requirements

### Requirement: 确认和取消操作

系统 SHALL 在浏览器菜单中提供确认下载和取消操作选项。这些操作选项属于「操作类」，在搜索过滤时始终可见。

#### Scenario: 确认下载

- **WHEN** 用户选择"✅ 确认下载"选项且已选择至少一个候选
- **THEN** 系统 SHALL 结束浏览循环，将所有已选候选传递给下载安装流程

#### Scenario: 无已选时确认

- **WHEN** 用户选择"✅ 确认下载"选项但未选择任何候选
- **THEN** 系统 SHALL 提示"未选择任何项目"并继续浏览循环

#### Scenario: 取消浏览

- **WHEN** 用户选择"❌ 取消"选项
- **THEN** 系统 SHALL 结束浏览循环，返回空列表，调用方负责清理临时目录

#### Scenario: 全选操作始终可见

- **WHEN** 当前层级存在可选择的条目（技能或资源），且用户正在输入搜索关键词
- **THEN** 🔘 全选/取消全选选项 SHALL 始终可见，其作用范围为当前层级的全部可选择条目（不限于过滤后的可见条目）
